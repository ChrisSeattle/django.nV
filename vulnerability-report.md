# Vulnerability Report

**Reviewer 1:** Chris L Chapman
**Reviewer 2:** Steph Harper

**Date:** 2018-10-10 15:27:37

## Reviewing [name]

## Vulnerability: A1 - Injection

### Exposure

We found an instance of A1 - Injection by typing: 

```SELECT 1 FROM USER WHERE user_id = 1; DROP TABLE user; -- AND access_level = 1```

in the projects file upload text box. Following this, we appeared to still be logged in, but there were no users present. At this point, viewing the dashboard gave us access to a long list of tasks that we previously did not have access to. 

We found an instance of A1 - Injection by typing: 
```SELECT 1 FROM USER WHERE user_id = 1 OR 1=1 AND access_level = 1``` 
in the projects file upload text box while logged in as a user. On the server, we saw a report of: 
```mv: target '1' is not a directory```

Apparently this SQL injection attempted to move a non-existent directory.

### Repair

Instead of using curs.execute or other direct functions in Django's ORM, we should use common ORM methods. Make sure to never pass user input to os.system(). Additionally, we can run checks in the Form class in Django. 

## Vulnerability: A2 - Broken Auth

### Exposure

Using the the default developer tools in chrome, we were able to add a checkbox element to the new user registration page exposing an A2 - Broken Auth vulnerability

```
<input type="checkbox" name="is_superuser" value="true" />
``` 
This allowed the new user to be granted superuser access rights so they could use the features usually reserved only for the admin.

### Repair

Instead of blacklisting all possible problematic input changes, it is better to whitelist allowed inputs.

## Vulnerability: A3 - XSS

### Exposure

We found an A3 - Cross Site Scripting vulnerability in the user's projects description. By adding the project description with the following code: 
```
<script>alert(You hAvE Beeen HACCKKKEEED!!!!!!!!!!!1!!!!!);</script>
```
At this point, the alert box with our text is activated when the user views their taskmanager page again. This could be used to insert more malicous code.

### Repair

The webserver can be configred with X-XSS-Protection. This header will configure the clients' browser to block XSS attacks it detects. In Django, setting SECURE_BROWSER_XSS_FILTER to True in configuration. 

## Vulnerability: A4 - Insecure DOR

### Exposure

The TaskManger projects are not secure from other users, opening an A4 - Insecure DOR vulnerability. We found that when logged in as user Ken, they could in fact add tasks to this project owned by the 'seth' user. He is not supposed to have access to the project with the id of 2 while this user was denied access to directly view the project. By editing the URL for task create, they were able to add the task:

```
taskManager/2/task_create/
```

We were able to confirm this task was successfully added and seen by user 'seth', when they next viewed this project.  

### Repair
User access should be checked and validated before any input can be added or viewed from the database. 
